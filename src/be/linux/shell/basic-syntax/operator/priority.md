---
title: 运算符优先级
order: 7
article: false
---

以下是Bash中运算符优先级的详细分类表格，根据不同的上下文（算术运算、条件测试、命令流程控制） 总体bash运算优先级和C语言相似。

---

### **Bash运算符优先级总表**

#### **1. 算术运算符优先级**

（在 `$(( ))` 或 `(( ))` 中）

| 优先级    | 运算符                      | 描述               | 示例                            |
| --------- | --------------------------- | ------------------ | ------------------------------- |
| 1 (最高)  | `()`                        | 分组               | `$(( (a + b) * c ))`            |
| 2         | `++` `--`                   | 自增、自减（后缀） | `a++`、`b--`                    |
| 3         | `++` `--`                   | 自增、自减（前缀） | `++a`、`--b`                    |
| 4         | `**`                        | 幂运算             | `$((2 ** 3))` → 8               |
| 5         | `!` `~`                     | 逻辑非、按位取反   | `$((!0))` → 1, `$((~5))` → -6   |
| 6         | `*` `/` `%`                 | 乘、除、取模       | `$((6 * 3 / 2))` → 9            |
| 7         | `+` `-`                     | 加、减             | `$((5 + 3 - 2))` → 6            |
| 8         | `<<` `>>`                   | 左移、右移         | `$((8 << 1))` → 16              |
| 9         | `&`                         | 按位与             | `$((5 & 3))` → 1                |
| 10        | `^`                         | 按位异或           | `$((5 ^ 3))` → 6                |
| 11        | `\|`                        | 按位或             | `$((5 \| 3))` → 7               |
| 12        | `==` `!=` `<` `>` `<=` `>=` | 比较运算           | `$((a > 5))` → 1（若a=10）      |
| 13        | `&&`                        | 逻辑与             | `$(( (a > 5) && (b < 10) ))`    |
| 14 (最低) | `\|\|`                      | 逻辑或             | `$(( (a == 0) \|\| (b == 0) ))` |

---

#### **2. 条件测试中的优先级**

（在 `[[ ]]` 中）

| 优先级   | 运算符               | 描述           | 示例                                |
| -------- | -------------------- | -------------- | ----------------------------------- |
| 1 (最高) | `()`                 | 分组           | `[[ (a > 5 || b < 0) && -f file ]]` |
| 2        | `!`                  | 逻辑非         | `[[ ! -d dir ]]`                    |
| 3        | `-e` `-f` `-d` 等    | 文件测试运算符 | `[[ -e file && -x script ]]`        |
| 4        | `==` `!=` `>` `<`    | 字符串比较     | `[[ "$str" == "yes" ]]`             |
| 5        | `=~`                 | 正则匹配       | `[[ "$str" =~ ^[0-9]+$ ]]`          |
| 6        | `-eq` `-ne` `-lt` 等 | 数值比较       | `[[ $a -gt 5 ]]`                    |
| 7        | `&&`                 | 逻辑与         | `[[ $a -eq 1 && $b == "ok" ]]`      |
| 8 (最低) | `\|\|`               | 逻辑或         | `[[ -f file \|\| -d dir ]]`         |

---

#### **3. 命令流程控制中的优先级**
| 优先级   | 运算符      | 描述                       | 示例                                                      |
| -------- | ----------- | -------------------------- | --------------------------------------------------------- |
| 1 (最高) | `;` `&` `|` | 命令分隔符、后台执行、管道 | `cmd1; cmd2 &` <br> `cmd1 | cmd2`                         |
| 2        | `&&` `||`   | 逻辑与、逻辑或             | `cmd1 && cmd2`（成功执行）<br> `cmd1 || cmd2`（失败执行） |
| 3 (最低) | `!`         | 逻辑非                     | `! cmd`（反转退出状态）                                   |

---

### **优先级规则总结**
1. **算术表达式**：  
   - 幂运算 `**` 优先级最高，逻辑或 `||` 最低。  
   - 使用 `()` 明确分组避免歧义，例如 `$(( (a + b) * c ))`。

2. **条件测试**：  
   - 文件测试和数值比较优先级高于逻辑运算符。  
   - `&&` 优先级高于 `||`，例如：  
     ```bash
     [[ $a > 5 || $b < 10 && -f file ]]  # 等价于 $a>5 或 ($b<10 且文件存在)
     ```

3. **命令流程控制**：  
   - `&&` 和 `||` 的优先级高于命令分隔符 `;` 或 `&`，例如：  
     ```bash
     cmd1 && cmd2 || cmd3; cmd4  # 等价于 (cmd1 && cmd2) || cmd3; cmd4
     ```

---

### **常见错误与避坑指南**
1. **混淆算术与字符串比较**：  
   ```bash
   [[ $a == 10 ]]    # 字符串比较（若$a未声明，会解析为"==" 10）
   [[ $a -eq 10 ]]   # 数值比较（确保$a是数字）
   ```

2. **忽略条件测试中的分组**：  
   ```bash
   [[ $a -gt 5 && $b -lt 10 || $c == "yes" ]]  # 等价于 ($a>5且$b<10) 或 $c=yes
   [[ ($a -gt 5 || $b -lt 10) && $c == "yes" ]]  # 明确分组
   ```

3. **误用命令控制符优先级**：  
   ```bash
   cmd1 && cmd2 || cmd3  # 若cmd1成功且cmd2失败，会执行cmd3
   cmd1; cmd2 || cmd3    # cmd2失败时执行cmd3，与cmd1无关
   ```

---

