---
title: 字符串运算符
order: 4
article: false
---

### 一、字符串比较运算符

| 运算符 | 描述                  | 示例                 |
| :----- | :-------------------- | :------------------- |
| `-z`   | 字符串长度为0         | `[[ -z "$str" ]]`    |
| `-n`   | 字符串长度非0         | `[[ -n "$str" ]]`    |
| `=`    | 字符串相等（同 `==`） | `[[ "$a" = "$b" ]]`  |
| `!=`   | 字符串不等            | `[[ "$a" != "$b" ]]` |

#### 1. 相等性比较

- **`=` 或 `==`**
  判断两个字符串是否相等。在 `[]` 中使用 `=`，在 `[[]]` 中两者等效。

  ```bash
  if [ "$str1" = "$str2" ]; then echo "相等"; fi    # 单括号中使用 =
  if [[ "$str1" == "$str2" ]]; then echo "相等"; fi # 双括号中使用 == 
  ```

- **`!=`**
  判断两个字符串是否不等。

  ```bash
  if [ "$str1" != "$str2" ]; then echo "不等"; fi 
  ```

#### 2. 空值检测

- **`-z`**
  检查字符串长度是否为0（空字符串）。

  ```bash
  if [ -z "$str" ]; then echo "字符串为空"; fi 
  ```

- **`-n`**
  检查字符串长度是否非0（非空字符串）。

  ```bash
  if [ -n "$str" ]; then echo "字符串非空"; fi 
  ```

- **直接检测变量**
  通过直接判断变量是否存在值（无需运算符）：

  ```bash
  if [ "$str" ]; then echo "非空"; else echo "空"; fi 
  ```

#### 3. 模式匹配

- **`=~`**（仅限 `[[]]`）
  使用正则表达式匹配字符串：

  ```bash
  if [[ "$str" =~ ^[0-9]+$ ]]; then echo "全为数字"; fi 
  ```

- **通配符匹配**
  在 `[[]]` 中使用 `==` 和通配符（如 `*`）进行模式匹配：

  ```bash
  if [[ "$file" == *.txt ]]; then echo "文本文件"; fi 
  ```

#### 4. 字典序比较

- `>` 和 `<`

  按字典顺序比较字符串。在`[]`中需转义，在`[[]]`中无需转义：

  ```bash
  if [[ "$str1" > "$str2" ]]; then echo "str1 在字典序中更大"; fi 
  if [ "$str1" \> "$str2" ]; then echo "str1 更大"; fi  # 需转义 
  ```

------

### 二、关键注意事项

1. **引号的使用**
   变量必须用双引号包裹，避免空值或含空格字符串导致错误：

   ```bash
   # 错误示例（若 $str 为空，会变成 [ = "value" ]，语法错误）
   if [ $str = "value" ]; then ... 
   # 正确示例 
   if [ "$str" = "value" ]; then ...
   ```

2. **`[]` 与 `[[]]` 的区别**

   - `[]` 是传统 `test` 命令，运算符需转义（如 `>` 需写为 `\>`）。
   - `[[]]` 是 Bash 扩展，支持模式匹配和正则表达式，逻辑操作更灵活。

3. **空变量处理**
   若变量未定义，建议赋默认值或检查存在性：

   ```bash
   # 检查变量是否存在 
   if [ -z "${var+x}" ]; then echo "var 未定义"; fi 
   ```

------

### 三、示例代码

#### 1. 基础比较

```bash
str1="hello"
str2="world"
 
if [[ "$str1" == "$str2" ]]; then 
    echo "字符串相等"
else 
    echo "字符串不等"  # 输出此结果 
fi 
```

#### 2. 空值检测

```bash
empty_str=""
if [ -z "$empty_str" ]; then 
    echo "检测到空字符串"  # 输出此结果 
fi 
```

#### 3. 正则匹配

```bash
email="user@example.com" 
if [[ "$email" =~ ^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$ ]]; then 
    echo "有效邮箱"  # 输出此结果 
fi 
```

#### 4. 字典序比较

```bash
a="apple"
b="banana"
if [[ "$a" < "$b" ]]; then 
    echo "apple 在字典序中先于 banana"  # 输出此结果 
fi 
```

------

### 四、常见错误

1. **未加引号导致语法错误**

   ```bash
   str="Hello World"
   if [ $str = "Hello World" ]; then ...  # 错误：$str 含空格，解析为多个参数 
   ```

2. **混淆 `=` 和 `-eq`**
   `-eq` 用于数值比较，`=` 用于字符串比较：

   ```bash
   num="123"
   if [ "$num" -eq 123 ]; then ...  # 正确（但建议用数值变量）
   if [ "$num" = "123" ]; then ...  # 正确（字符串比较）
   ```

