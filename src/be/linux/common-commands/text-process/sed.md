---
title: sed
article: false
order: 
---

sed（stream editor）是一个非常强大的文本处理工具，它用于对文本进行查找、替换、插入、删除等操作，通常用于批量处理和自动化脚本中。以下是对sed命令的详细解析：

### 一、基本语法

sed命令的基本语法如下：

```bash
bash复制代码

sed [options] 'command' file
```

- `options`：sed命令的选项，用于指定sed命令的行为。例如，-i用于直接修改文件，-e用于执行多个命令等。
- `command`：用于指定编辑操作的命令，可以是单个命令或多个命令的组合。
- `file`：要处理的输入文件名。如果没有指定文件，sed将从标准输入（通常是键盘）读取数据。

### 二、常用选项

- `-e`：允许在命令行中指定多个编辑命令。
- `-f`：表示用指定的脚本文件来处理输入的文本文件。
- `-h`：显示帮助。
- `-i`：直接在输入文件中进行编辑（原地编辑），而不是在标准输出上打印结果。如果希望创建备份文件，可以使用`-i.bak`选项，这样原文件会被修改，并创建一个扩展名为.bak的备份文件。
- `-n`：禁止默认输出，只打印被处理的文本。通常和`p`命令一起使用。
- `-r`或`-E`：使用扩展正则表达式，它支持更复杂的正则表达式语法。
- `-s`：将多个文件视为独立文件，而不是单个连续的长文件流。

### 三、常用命令

- `s`：替换指定字符。格式为`s/pattern/replacement/[flags]`，其中`pattern`是要查找的内容（可以是正则表达式），`replacement`是替换成的内容，`[flags]`是可选的标志位，如`g`表示全局替换，`i`表示忽略大小写进行匹配。
- `d`：删除选定的行。
- `a`：增加，在当前行下面增加一行指定内容。
- `i`：插入，在选定行上面插入一行指定内容。
- `c`：替换，将选定行替换为指定内容。
- `p`：打印，如果同时指定行，表示打印指定行；如果不指定行，则表示打印所有内容。
- `y`：字符转换，对指定范围内的字符进行一对一的转换。

### 四、地址范围

sed命令可以指定处理的行范围，常用运算符是`,`，表示一个行范围。例如，`sed '2,4s/foo/bar/' file.txt`表示将第2行到第4行之间的`foo`替换为`bar`。

### 五、使用示例

1. **替换文本**

将文件`file.txt`中的第一个`hello`替换为`world`：

```bash
bash复制代码

sed 's/hello/world/' file.txt
```

将文件`file.txt`中的所有`orange`替换为`peach`：

```bash
bash复制代码

sed 's/orange/peach/g' file.txt
```

1. **删除特定行**

删除文件`file.txt`的第3行：

```bash
bash复制代码

sed '3d' file.txt
```

删除文件`file.txt`中所有包含`pattern`的行：

```bash
bash复制代码

sed '/pattern/d' file.txt
```

1. **插入和追加文本**

在文件`file.txt`的第5行之前插入一行内容`mango`：

```bash
bash复制代码

sed '5i\mango' file.txt
```

在文件`file.txt`的最后一行追加一行内容`This is the last line.`：

```bash
bash复制代码

sed '$aThis is the last line.' file.txt
```

1. **使用正则表达式**

在文件`file.txt`中查找所有以`start`开头，`end`结尾的行，并将其替换为`match`：

```bash
bash复制代码

sed 's/^start.*end$/match/' file.txt
```

删除文件`file.txt`中所有包含数字的行：

```bash
bash复制代码

sed '/[0-9]/d' file.txt
```

1. **标签和跳转**（高级用法）

sed命令还支持标签和跳转功能，但这里不展开详细介绍，因为在实际应用中较少使用。

### 六、应用场景

- **文本替换**：在配置文件中批量替换特定的配置项。
- **日志处理**：从日志文件中提取关键信息或进行格式化处理。
- **数据清洗**：对文本数据进行清洗、过滤和转换操作。

综上所述，sed命令是一款功能强大且灵活的文本处理工具。通过掌握sed命令的基本语法、常用选项、常用命令以及地址范围等知识点，用户可以高效地处理各种文本数据。