---
title: 贪婪和非贪婪
article: false
order: 2
---

[[toc]]

### 贪婪模式（Greedy）

#### 特点：

- **尽可能多地匹配**：默认情况下，大多数量词都是贪婪的。这意味着当使用这些量词时，正则表达式引擎会尝试尽可能多地匹配输入字符串中的字符。
- **回溯机制**：如果在某个位置无法继续匹配，则正则表达式引擎会逐步回溯，尝试减少匹配的数量，直到找到一个成功的匹配或所有可能都已尝试完毕。

```
<.*>
```

对于字符串 `<div>hello</div>`，这个正则表达式会匹配从第一个 `<` 到最后一个 `>` 之间的所有内容，即整个 `<div>hello</div>`。这是因为 `.*` 是贪婪的，它会尽可能多地匹配字符，直到遇到最右边的 `>`。

### 非贪婪模式（Lazy 或 Non-greedy）

#### 特点：

- **尽可能少地匹配**：当在量词后面加上 `?` 时，该量词变为非贪婪模式。在这种模式下，量词会尽可能少地匹配字符，只要满足整体模式的要求即可。
- **避免过度匹配**：非贪婪模式通常用于避免贪婪模式可能导致的过度匹配问题，特别是在处理嵌套结构或多实例数据时。

```
<.*?>
```

对于相同的字符串 `<div>hello</div>`，这个正则表达式会分别匹配每个标签内的内容，即只匹配 `<div>` 和 `</div>` 中间的内容 `hello`。这是因为 `.*?` 是非贪婪的，它会尽可能少地匹配字符，直到遇到最近的 `>`。

### 量词及其贪婪/非贪婪形式

| 量词    | 含义                               | 非贪婪形式 | 含义                                         |
| ------- | ---------------------------------- | ---------- | -------------------------------------------- |
| `*`     | 匹配前面的元素零次或多次           | `*?`       | 尽可能少地匹配前面的元素零次或多次           |
| `+`     | 匹配前面的元素一次或多次           | `+?`       | 尽可能少地匹配前面的元素一次或多次           |
| `?`     | 匹配前面的元素零次或一次           | `??`       | 尽可能少地匹配前面的元素零次或一次           |
| `{n}`   | 匹配前面的元素恰好 n 次            | `{n}?`     | 匹配前面的元素恰好 n 次（等价于 `{n}`）      |
| `{n,}`  | 匹配前面的元素至少 n 次            | `{n,}?`    | 尽可能少地匹配前面的元素至少 n 次            |
| `{n,m}` | 匹配前面的元素最少 n 次，最多 m 次 | `{n,m}?`   | 尽可能少地匹配前面的元素最少 n 次，最多 m 次 |

### 实际应用中的差异

- **贪婪模式**：适用于你希望尽可能多地匹配字符的情况，例如当你确切知道你的匹配应该涵盖尽可能多的内容时。
- **非贪婪模式**：当你需要更精细控制匹配长度时非常有用，特别是当你处理包含多个潜在匹配项的文本时，可以避免过度匹配的问题。
